<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Penetration Test Report - IPTF_AbuAli</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Penetration Test Report</h1>
            <p><strong>Target:</strong> {{ target }}</p>
            <p><strong>Date:</strong> {{ date }}</p>
        </header>

        <section id="summary">
            <h2>Summary of Findings</h2>
            <ul>
                {% if report.recon %}
                    <li>‚úÖ Reconnaissance: Completed with {{ report.recon | length }} findings</li>
                {% else %}
                    <li>‚ùå Reconnaissance: No data collected</li>
                {% endif %}

                {% if report.scan %}
                    <li>‚úÖ Scanning: Detected {{ report.scan.nuclei.split('\n') | length }} vulnerabilities</li>
                {% else %}
                    <li>‚ùå Scanning: No scan results found</li>
                {% endif %}

                {% if report.exploit %}
                    <li>‚úÖ Exploitation: {{ report.exploit.sqlmap.count('SQL injection') }} SQLi attempts</li>
                {% else %}
                    <li>‚ùå Exploitation: No exploits attempted</li>
                {% endif %}

                {% if report.post %}
                    <li>‚úÖ Post-Exploitation: Logged activity detected</li>
                {% else %}
                    <li>‚ùå Post-Exploitation: No post-exploitation actions performed</li>
                {% endif %}
            </ul>
        </section>

        <section id="details">
            <h2>Detailed Findings</h2>

            <!-- Reconnaissance -->
            <div class="module-section">
                <h3>üîç Reconnaissance & Intelligence Gathering</h3>
                {% if report.recon %}
                    <pre>{{ report.recon.harvester }}</pre>
                {% else %}
                    <p>No reconnaissance data available.</p>
                {% endif %}
            </div>

            <!-- Vulnerability Scanning -->
            <div class="module-section">
                <h3>üõ°Ô∏è Vulnerability Scanning (Nuclei)</h3>
                {% if report.scan %}
                    <pre>{{ report.scan.nuclei }}</pre>
                {% else %}
                    <p>No scan results found.</p>
                {% endif %}
            </div>

            <!-- Exploitation -->
            <div class="module-section">
                <h3>üí£ Exploitation Results (SQLMap)</h3>
                {% if report.exploit %}
                    <pre>{{ report.exploit.sqlmap }}</pre>
                {% else %}
                    <p>No exploitation attempts were made.</p>
                {% endif %}
            </div>

            <!-- Post-Exploitation -->
            <div class="module-section">
                <h3>üïµÔ∏è‚Äç‚ôÇÔ∏è Post-Exploitation Logs</h3>
                {% if report.post %}
                    <pre>{{ report.post.empire }}</pre>
                {% else %}
                    <p>No post-exploitation activities recorded.</p>
                {% endif %}
            </div>
        </section>

        <footer>
            <p>Generated by <strong>IPTF_AbuAli Framework</strong> ‚Äì Integrated Penetration Testing Framework</p>
            <p>¬© 2025 [Your Name]. Released under MIT License.</p>
        </footer>

        <a href="/download" class="btn-download">üì• Download Full Report (JSON)</a>
        <a href="/" class="btn-back">‚¨ÖÔ∏è Run Another Test</a>
    </div>
</body>
</html>